-- Script de Rueda de Mensajes - Versión Funcional
local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local TweenService = game:GetService("TweenService")

local player = Players.LocalPlayer

-- Configuración
local WHEEL_SECTIONS = 8
local WHEEL_RADIUS = 100

-- Tus mensajes personalizados
local SECTION_DATA = {
    {text = "ez", color = Color3.fromRGB(255, 100, 100)},
    {text = "desintala", color = Color3.fromRGB(255, 200, 100)},
    {text = "chill", color = Color3.fromRGB(100, 255, 100)},
    {text = "remato", color = Color3.fromRGB(100, 200, 255)},
    {text = "stfu", color = Color3.fromRGB(200, 100, 255)},
    {text = "tranquilo", color = Color3.fromRGB(255, 100, 200)},
    {text = "malo", color = Color3.fromRGB(100, 255, 255)},
    {text = "my bad", color = Color3.fromRGB(255, 255, 100)}
}

-- Variables globales
local wheelGUI, sections = {}, centerCircle, mainFrame, selectedLabel
local isWheelVisible = false

-- Función para crear la GUI (similar a los scripts anteriores que funcionaban)
local function createWheelGUI()
    local screenGui = Instance.new("ScreenGui")
    screenGui.Name = "MessageWheel"
    
    -- Usar el mismo sistema de parent que en los scripts anteriores
    if gethui then
        screenGui.Parent = gethui()
    elseif syn and syn.protect_gui then
        syn.protect_gui(screenGui)
        screenGui.Parent = game:GetService("CoreGui")
    else
        screenGui.Parent = game:GetService("CoreGui")
    end

    -- Marco principal
    mainFrame = Instance.new("Frame")
    mainFrame.Name = "MainFrame"
    mainFrame.Size = UDim2.new(0, 250, 0, 250)
    mainFrame.Position = UDim2.new(0.5, -125, 0.5, -125)
    mainFrame.BackgroundColor3 = Color3.fromRGB(40, 40, 45)
    mainFrame.BackgroundTransparency = 0.1
    mainFrame.BorderSizePixel = 0
    mainFrame.Visible = true
    
    local mainCorner = Instance.new("UICorner")
    mainCorner.CornerRadius = UDim.new(0.1, 0)
    mainCorner.Parent = mainFrame

    -- Botón central
    centerCircle = Instance.new("TextButton")
    centerCircle.Name = "CenterButton"
    centerCircle.Size = UDim2.new(0, 80, 0, 80)
    centerCircle.Position = UDim2.new(0.5, -40, 0.5, -40)
    centerCircle.AnchorPoint = Vector2.new(0.5, 0.5)
    centerCircle.BackgroundColor3 = Color3.fromRGB(0, 120, 255)
    centerCircle.BorderSizePixel = 0
    centerCircle.Text = "MENSAJES"
    centerCircle.TextColor3 = Color3.fromRGB(255, 255, 255)
    centerCircle.TextScaled = true
    centerCircle.Font = Enum.Font.GothamBold
    centerCircle.ZIndex = 10
    centerCircle.Visible = true
    
    local centerCorner = Instance.new("UICorner")
    centerCorner.CornerRadius = UDim.new(1, 0)
    centerCorner.Parent = centerCircle

    centerCircle.Parent = mainFrame

    -- Crear secciones
    local angleStep = 360 / WHEEL_SECTIONS
    
    for i = 1, WHEEL_SECTIONS do
        local sectionData = SECTION_DATA[i]
        
        -- Calcular posición en círculo
        local angle = math.rad((i - 1) * angleStep + angleStep/2)
        local x = math.cos(angle) * WHEEL_RADIUS
        local y = math.sin(angle) * WHEEL_RADIUS
        
        -- Crear botón de sección
        local section = Instance.new("TextButton")
        section.Name = "Section_" .. i
        section.Size = UDim2.new(0, 60, 0, 60)
        section.Position = UDim2.new(0.5, x - 30, 0.5, y - 30)
        section.AnchorPoint = Vector2.new(0.5, 0.5)
        section.BackgroundColor3 = sectionData.color
        section.BackgroundTransparency = 0.3
        section.BorderSizePixel = 0
        section.Text = sectionData.text
        section.TextColor3 = Color3.fromRGB(255, 255, 255)
        section.TextScaled = true
        section.Font = Enum.Font.GothamBold
        section.ZIndex = 5
        section.Visible = false
        
        local sectionCorner = Instance.new("UICorner")
        sectionCorner.CornerRadius = UDim.new(0.2, 0)
        sectionCorner.Parent = section

        section.Parent = mainFrame
        sections[i] = section
    end

    -- Etiqueta de selección
    selectedLabel = Instance.new("TextLabel")
    selectedLabel.Name = "SelectedLabel"
    selectedLabel.Size = UDim2.new(1, -20, 0, 30)
    selectedLabel.Position = UDim2.new(0, 10, 1, 5)
    selectedLabel.BackgroundColor3 = Color3.fromRGB(30, 30, 35)
    selectedLabel.BackgroundTransparency = 0.2
    selectedLabel.Text = "Selecciona un mensaje"
    selectedLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    selectedLabel.TextScaled = true
    selectedLabel.Font = Enum.Font.Gotham
    selectedLabel.Visible = false
    selectedLabel.ZIndex = 15
    
    local selectedCorner = Instance.new("UICorner")
    selectedCorner.CornerRadius = UDim.new(0.1, 0)
    selectedCorner.Parent = selectedLabel

    selectedLabel.Parent = mainFrame
    mainFrame.Parent = screenGui
    
    return screenGui
end

-- Función para mostrar la rueda
local function showWheel()
    isWheelVisible = true
    centerCircle.Visible = false
    
    for i, section in ipairs(sections) do
        section.Visible = true
        section.BackgroundTransparency = 0.3
    end
    
    if selectedLabel then
        selectedLabel.Visible = true
        selectedLabel.Text = "Toca un mensaje"
    end
end

-- Función para ocultar la rueda
local function hideWheel()
    isWheelVisible = false
    
    for i, section in ipairs(sections) do
        section.Visible = false
    end
    
    if selectedLabel then
        selectedLabel.Visible = false
    end
    
    centerCircle.Visible = true
end

-- Función para enviar mensaje (igual que en scripts anteriores)
local function sendMessage(message)
    print("Mensaje: " .. message)
    
    -- Intentar enviar al chat del juego
    local success, result = pcall(function()
        local chatEvents = game:GetService("ReplicatedStorage"):FindFirstChild("DefaultChatSystemChatEvents")
        if chatEvents then
            local sayMessage = chatEvents:FindFirstChild("SayMessageRequest")
            if sayMessage then
                sayMessage:FireServer(message, "All")
            end
        end
    end)
    
    if not success then
        -- Método alternativo
        pcall(function()
            game:GetService("TextChatService").TextChannels.RBXGeneral:SendAsync(message)
        end)
    end
end

-- Función principal (estructura similar a scripts anteriores)
local function initializeWheel()
    wheelGUI = createWheelGUI()
    
    print("Rueda de mensajes cargada!")
    print("Controles:")
    print("- Toca el botón azul para abrir/cerrar")
    print("- Toca cualquier sección para enviar mensaje")

    -- Configurar botón central
    centerCircle.MouseButton1Click:Connect(function()
        if isWheelVisible then
            hideWheel()
        else
            showWheel()
        end
    end)

    -- Configurar secciones
    for i, section in ipairs(sections) do
        section.MouseButton1Click:Connect(function()
            if not isWheelVisible then return end
            
            local sectionData = SECTION_DATA[i]
            local message = sectionData.text
            
            -- Efecto visual
            local originalTransparency = section.BackgroundTransparency
            section.BackgroundTransparency = 0
            
            -- Mostrar selección
            if selectedLabel then
                selectedLabel.Text = "Enviado: " .. message
            end
            
            -- Enviar mensaje
            sendMessage(message)
            
            -- Restaurar y ocultar después de un momento
            delay(1.5, function()
                if section then
                    section.BackgroundTransparency = originalTransparency
                end
                if isWheelVisible then
                    hideWheel()
                end
            end)
        end)
    end
    
    -- Hacer movible (como en scripts anteriores)
    local dragging = false
    local dragStart = nil
    local startPos = nil
    
    mainFrame.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.Touch or input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true
            dragStart = input.Position
            startPos = mainFrame.Position
            mainFrame.BackgroundTransparency = 0.05
        end
    end)
    
    mainFrame.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.Touch or input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = false
            mainFrame.BackgroundTransparency = 0.1
        end
    end)
    
    UserInputService.InputChanged:Connect(function(input)
        if dragging and (input.UserInputType == Enum.UserInputType.Touch or input.UserInputType == Enum.UserInputType.MouseMovement) then
            local delta = input.Position - dragStart
            mainFrame.Position = UDim2.new(
                startPos.X.Scale, 
                startPos.X.Offset + delta.X,
                startPos.Y.Scale, 
                startPos.Y.Offset + delta.Y
            )
        end
    end)
end

-- Inicializar inmediatamente
initializeWheel()
