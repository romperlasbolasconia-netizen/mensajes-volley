-- Script de Rueda de Mensajes para M√≥vil - Versi√≥n Mejorada
local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local TweenService = game:GetService("TweenService")

local player = Players.LocalPlayer

-- Configuraci√≥n para m√≥vil
local WHEEL_SECTIONS = 6
local WHEEL_RADIUS = 100
local CENTER_POSITION = UDim2.new(0.15, 0, 0.8, 0)

-- Mensajes y emojis para cada secci√≥n
local SECTION_DATA = {
    {text = "¬°Hola!", emoji = "üëã", color = Color3.fromRGB(255, 100, 100)},
    {text = "¬°Genial!", emoji = "üòé", color = Color3.fromRGB(255, 200, 100)},
    {text = "¬°Ayuda!", emoji = "üÜò", color = Color3.fromRGB(100, 255, 100)},
    {text = "¬°Gracias!", emoji = "üôè", color = Color3.fromRGB(100, 200, 255)},
    {text = "¬°Wow!", emoji = "üòÆ", color = Color3.fromRGB(200, 100, 255)},
    {text = "¬°Risa!", emoji = "üòÇ", color = Color3.fromRGB(255, 100, 200)}
}

-- Variables globales
local wheelGUI, sections = {}, centerCircle, mainFrame
local isWheelVisible = false
local wheelCenter = nil

-- Funci√≥n para crear la interfaz
local function createWheelGUI()
    local screenGui = Instance.new("ScreenGui")
    screenGui.Name = "MessageWheelMobile"
    screenGui.ResetOnSpawn = false
    
    -- Marco principal
    mainFrame = Instance.new("Frame")
    mainFrame.Name = "MainFrame"
    mainFrame.Size = UDim2.new(0, 220, 0, 220)
    mainFrame.Position = CENTER_POSITION
    mainFrame.BackgroundColor3 = Color3.fromRGB(40, 40, 45)
    mainFrame.BackgroundTransparency = 0.2
    mainFrame.BorderSizePixel = 0
    mainFrame.Visible = true
    
    local mainCorner = Instance.new("UICorner")
    mainCorner.CornerRadius = UDim.new(0.1, 0)
    mainCorner.Parent = mainFrame
    
    local mainStroke = Instance.new("UIStroke")
    mainStroke.Color = Color3.fromRGB(255, 255, 255)
    mainStroke.Thickness = 2
    mainStroke.Parent = mainFrame
    
    -- Bot√≥n central para abrir/cerrar
    centerCircle = Instance.new("TextButton")
    centerCircle.Name = "CenterButton"
    centerCircle.Size = UDim2.new(0, 80, 0, 80)
    centerCircle.Position = UDim2.new(0.5, -40, 0.5, -40)
    centerCircle.AnchorPoint = Vector2.new(0.5, 0.5)
    centerCircle.BackgroundColor3 = Color3.fromRGB(0, 120, 255)
    centerCircle.BorderSizePixel = 0
    centerCircle.Text = "üí¨\nMENSAJES"
    centerCircle.TextColor3 = Color3.fromRGB(255, 255, 255)
    centerCircle.TextScaled = true
    centerCircle.Font = Enum.Font.GothamBold
    centerCircle.ZIndex = 10
    centerCircle.Visible = true
    
    local centerCorner = Instance.new("UICorner")
    centerCorner.CornerRadius = UDim.new(1, 0)
    centerCorner.Parent = centerCircle
    
    local centerStroke = Instance.new("UIStroke")
    centerStroke.Color = Color3.fromRGB(255, 255, 255)
    centerStroke.Thickness = 3
    centerStroke.Parent = centerCircle
    
    centerCircle.Parent = mainFrame
    
    -- Crear secciones visibles como botones
    local angleStep = 360 / WHEEL_SECTIONS
    
    for i = 1, WHEEL_SECTIONS do
        local sectionData = SECTION_DATA[i]
        
        -- Calcular posici√≥n en c√≠rculo
        local angle = math.rad((i - 1) * angleStep + angleStep/2)
        local x = math.cos(angle) * WHEEL_RADIUS
        local y = math.sin(angle) * WHEEL_RADIUS
        
        -- Crear bot√≥n de secci√≥n
        local section = Instance.new("TextButton")
        section.Name = "Section_" .. i
        section.Size = UDim2.new(0, 70, 0, 70)
        section.Position = UDim2.new(0.5, x - 35, 0.5, y - 35)
        section.AnchorPoint = Vector2.new(0.5, 0.5)
        section.BackgroundColor3 = sectionData.color
        section.BackgroundTransparency = 0.2
        section.BorderSizePixel = 0
        section.Text = sectionData.emoji .. "\n" .. string.sub(sectionData.text, 1, 4)
        section.TextColor3 = Color3.fromRGB(255, 255, 255)
        section.TextScaled = true
        section.Font = Enum.Font.GothamBold
        section.ZIndex = 5
        section.Visible = false
        
        local sectionCorner = Instance.new("UICorner")
        sectionCorner.CornerRadius = UDim.new(0.2, 0)
        sectionCorner.Parent = section
        
        local sectionStroke = Instance.new("UIStroke")
        sectionStroke.Color = Color3.fromRGB(255, 255, 255)
        sectionStroke.Thickness = 2
        sectionStroke.Parent = section
        
        -- Tooltip para mostrar texto completo
        local tooltip = Instance.new("TextLabel")
        tooltip.Name = "Tooltip"
        tooltip.Size = UDim2.new(1.5, 0, 0, 30)
        tooltip.Position = UDim2.new(0.5, 0, -0.5, 0)
        tooltip.AnchorPoint = Vector2.new(0.5, 1)
        tooltip.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
        tooltip.BackgroundTransparency = 0.3
        tooltip.Text = sectionData.text
        tooltip.TextColor3 = Color3.fromRGB(255, 255, 255)
        tooltip.TextScaled = true
        tooltip.Font = Enum.Font.Gotham
        tooltip.Visible = false
        tooltip.ZIndex = 20
        
        local tooltipCorner = Instance.new("UICorner")
        tooltipCorner.CornerRadius = UDim.new(0.1, 0)
        tooltipCorner.Parent = tooltip
        
        tooltip.Parent = section
        
        section.Parent = mainFrame
        sections[i] = section
    end
    
    -- Etiqueta de mensaje seleccionado
    local selectedLabel = Instance.new("TextLabel")
    selectedLabel.Name = "SelectedLabel"
    selectedLabel.Size = UDim2.new(1, -20, 0, 40)
    selectedLabel.Position = UDim2.new(0, 10, 1, 10)
    selectedLabel.BackgroundColor3 = Color3.fromRGB(30, 30, 35)
    selectedLabel.BackgroundTransparency = 0.1
    selectedLabel.Text = "Toca un bot√≥n para enviar mensaje"
    selectedLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    selectedLabel.TextScaled = true
    selectedLabel.Font = Enum.Font.GothamBold
    selectedLabel.Visible = false
    selectedLabel.ZIndex = 15
    
    local selectedCorner = Instance.new("UICorner")
    selectedCorner.CornerRadius = UDim.new(0.1, 0)
    selectedCorner.Parent = selectedLabel
    
    local selectedStroke = Instance.new("UIStroke")
    selectedStroke.Color = Color3.fromRGB(255, 255, 255)
    selectedStroke.Thickness = 1
    selectedStroke.Parent = selectedLabel
    
    selectedLabel.Parent = mainFrame
    
    mainFrame.Parent = screenGui
    return screenGui, selectedLabel
end

-- Funci√≥n para mostrar la rueda con animaci√≥n
local function showWheel()
    isWheelVisible = true
    centerCircle.Visible = false
    
    -- Mostrar todas las secciones
    for i, section in ipairs(sections) do
        section.Visible = true
        section.BackgroundTransparency = 0.2
        
        -- Animaci√≥n de escala
        section.Size = UDim2.new(0, 10, 0, 10)
        local tweenInfo = TweenInfo.new(0.3, Enum.EasingStyle.Back, Enum.EasingDirection.Out)
        local tween = TweenService:Create(section, tweenInfo, {Size = UDim2.new(0, 70, 0, 70)})
        tween:Play()
    end
    
    -- Mostrar instrucci√≥n
    if selectedLabel then
        selectedLabel.Visible = true
        selectedLabel.Text = "üëÜ Toca un bot√≥n para enviar mensaje"
    end
    
    -- Actualizar posici√≥n central para detecci√≥n de toques
    local centerAbsPos = mainFrame.AbsolutePosition
    local centerSize = mainFrame.AbsoluteSize
    wheelCenter = Vector2.new(
        centerAbsPos.X + centerSize.X / 2,
        centerAbsPos.Y + centerSize.Y / 2
    )
end

-- Funci√≥n para ocultar la rueda con animaci√≥n
local function hideWheel()
    isWheelVisible = false
    
    -- Animaci√≥n para ocultar
    for i, section in ipairs(sections) do
        local tweenInfo = TweenInfo.new(0.2, Enum.EasingStyle.Back, Enum.EasingDirection.In)
        local tween = TweenService:Create(section, tweenInfo, {Size = UDim2.new(0, 10, 0, 10)})
        tween:Play()
        
        delay(0.2, function()
            section.Visible = false
        end)
    end
    
    if selectedLabel then
        selectedLabel.Visible = false
    end
    
    centerCircle.Visible = true
end

-- Funci√≥n para enviar mensaje
local function sendMessage(message)
    print("üì± Mensaje enviado: " .. message)
    
    -- Intentar enviar al chat del juego
    local success, result = pcall(function()
        local chatService = game:GetService("ReplicatedStorage"):FindFirstChild("DefaultChatSystemChatEvents")
        if chatService then
            chatService:FindFirstChild("SayMessageRequest"):FireServer(message, "All")
        end
    end)
    
    if not success then
        print("‚ö†Ô∏è No se pudo enviar al chat, pero el mensaje es: " .. message)
    end
end

-- Funci√≥n para mostrar tooltip
local function showTooltip(section, show)
    local tooltip = section:FindFirstChild("Tooltip")
    if tooltip then
        tooltip.Visible = show
    end
end

-- Funci√≥n principal
local function initializeWheel()
    wheelGUI, selectedLabel = createWheelGUI()
    
    -- Insertar en la interfaz
    if gethui then
        wheelGUI.Parent = gethui()
    elseif syn and syn.protect_gui then
        syn.protect_gui(wheelGUI)
        wheelGUI.Parent = game:GetService("CoreGui")
    else
        wheelGUI.Parent = game:GetService("CoreGui")
    end

    -- Configurar bot√≥n central
    centerCircle.MouseButton1Click:Connect(function()
        if isWheelVisible then
            hideWheel()
        else
            showWheel()
        end
    end)

    -- Configurar secciones
    for i, section in ipairs(sections) do
        -- Evento para tocar
        section.MouseButton1Click:Connect(function()
            if not isWheelVisible then return end
            
            local sectionData = SECTION_DATA[i]
            local fullMessage = sectionData.emoji .. " " .. sectionData.text
            
            -- Efecto visual al seleccionar
            section.BackgroundTransparency = 0
            section.Text = "‚úì"
            
            -- Mostrar mensaje seleccionado
            if selectedLabel then
                selectedLabel.Text = "‚úÖ " .. fullMessage
            end
            
            -- Enviar mensaje
            sendMessage(fullMessage)
            
            -- Restaurar apariencia despu√©s de un momento
            delay(1, function()
                if section then
                    section.BackgroundTransparency = 0.2
                    section.Text = sectionData.emoji .. "\n" .. string.sub(sectionData.text, 1, 4)
                end
            end)
            
            -- Ocultar rueda despu√©s de 2 segundos
            delay(2, function()
                if isWheelVisible then
                    hideWheel()
                end
            end)
        end)
        
        -- Eventos para tooltips
        section.MouseEnter:Connect(function()
            showTooltip(section, true)
        end)
        
        section.MouseLeave:Connect(function()
            showTooltip(section, false)
        end)
    end
    
    -- Hacer la ventana movible
    local dragging = false
    local dragStart = nil
    local startPos = nil
    
    mainFrame.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.Touch then
            dragging = true
            dragStart = input.Position
            startPos = mainFrame.Position
        end
    end)
    
    mainFrame.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.Touch then
            dragging = false
        end
    end)
    
    UserInputService.InputChanged:Connect(function(input)
        if dragging and input.UserInputType == Enum.UserInputType.Touch then
            local delta = input.Position - dragStart
            mainFrame.Position = UDim2.new(
                startPos.X.Scale, 
                startPos.X.Offset + delta.X,
                startPos.Y.Scale, 
                startPos.Y.Offset + delta.Y
            )
        end
    end)
    
    print("üéØ Rueda de mensajes m√≥vil CARGADA")
    print("üí¨ Toca el bot√≥n azul central para abrir")
    print("üëÜ Los botones muestran emoji y texto")
    print("üß≠ Arrastra para mover la ventana")
end

-- Inicializar
initializeWheel()
